(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[3],{"9LOX":function(e,n,t){"use strict";t.r(n),t.d(n,"FetchError",(function(){return E})),t.d(n,"SolidClientError",(function(){return d})),t.d(n,"ThingExpectedError",(function(){return gn})),t.d(n,"access",(function(){return Pi})),t.d(n,"acp_v1",(function(){return Mc})),t.d(n,"acp_v2",(function(){return $c})),t.d(n,"acp_v3",(function(){return Bc})),t.d(n,"addBoolean",(function(){return qn})),t.d(n,"addDatetime",(function(){return Gn})),t.d(n,"addDecimal",(function(){return Bn})),t.d(n,"addInteger",(function(){return zn})),t.d(n,"addIri",(function(){return xn})),t.d(n,"addLiteral",(function(){return Vn})),t.d(n,"addMockFallbackAclTo",(function(){return $r})),t.d(n,"addMockResourceAclTo",(function(){return Lr})),t.d(n,"addNamedNode",(function(){return Jn})),t.d(n,"addStringNoLocale",(function(){return Hn})),t.d(n,"addStringWithLocale",(function(){return Xn})),t.d(n,"addTerm",(function(){return Zn})),t.d(n,"addUrl",(function(){return Fn})),t.d(n,"asIri",(function(){return sn})),t.d(n,"asUrl",(function(){return ln})),t.d(n,"changeLogAsMarkdown",(function(){return $n})),t.d(n,"createAcl",(function(){return Qt})),t.d(n,"createAclFromFallbackAcl",(function(){return Yt})),t.d(n,"createContainerAt",(function(){return Rn})),t.d(n,"createContainerInContainer",(function(){return Tn})),t.d(n,"createSolidDataset",(function(){return An})),t.d(n,"createThing",(function(){return un})),t.d(n,"deleteAclFor",(function(){return er})),t.d(n,"deleteContainer",(function(){return Pn})),t.d(n,"deleteFile",(function(){return k})),t.d(n,"deleteSolidDataset",(function(){return vn})),t.d(n,"getAgentAccess",(function(){return tr})),t.d(n,"getAgentAccessAll",(function(){return rr})),t.d(n,"getAgentDefaultAccess",(function(){return ur})),t.d(n,"getAgentDefaultAccessAll",(function(){return ar})),t.d(n,"getAgentResourceAccess",(function(){return or})),t.d(n,"getAgentResourceAccessAll",(function(){return cr})),t.d(n,"getBoolean",(function(){return Te})),t.d(n,"getBooleanAll",(function(){return Pe})),t.d(n,"getContainedResourceUrlAll",(function(){return Cn})),t.d(n,"getContentType",(function(){return P})),t.d(n,"getDatetime",(function(){return Ce})),t.d(n,"getDatetimeAll",(function(){return Le})),t.d(n,"getDecimal",(function(){return $e})),t.d(n,"getDecimalAll",(function(){return Ie})),t.d(n,"getFallbackAcl",(function(){return Zt})),t.d(n,"getFile",(function(){return N})),t.d(n,"getFileWithAcl",(function(){return Xt})),t.d(n,"getGroupAccess",(function(){return hr})),t.d(n,"getGroupAccessAll",(function(){return pr})),t.d(n,"getGroupDefaultAccess",(function(){return Ar})),t.d(n,"getGroupDefaultAccessAll",(function(){return yr})),t.d(n,"getGroupResourceAccess",(function(){return wr})),t.d(n,"getGroupResourceAccessAll",(function(){return br})),t.d(n,"getInteger",(function(){return Ee})),t.d(n,"getIntegerAll",(function(){return De})),t.d(n,"getIri",(function(){return Oe})),t.d(n,"getIriAll",(function(){return Ue})),t.d(n,"getLiteral",(function(){return qe})),t.d(n,"getLiteralAll",(function(){return Ge})),t.d(n,"getNamedNode",(function(){return Fe})),t.d(n,"getNamedNodeAll",(function(){return xe})),t.d(n,"getPodOwner",(function(){return $})),t.d(n,"getPublicAccess",(function(){return Or})),t.d(n,"getPublicDefaultAccess",(function(){return Ur})),t.d(n,"getPublicResourceAccess",(function(){return _r})),t.d(n,"getResourceAcl",(function(){return Jt})),t.d(n,"getResourceInfo",(function(){return _})),t.d(n,"getResourceInfoWithAcl",(function(){return Ht})),t.d(n,"getSolidDataset",(function(){return yn})),t.d(n,"getSolidDatasetWithAcl",(function(){return zt})),t.d(n,"getSourceIri",(function(){return L})),t.d(n,"getSourceUrl",(function(){return C})),t.d(n,"getStringByLocaleAll",(function(){return ke})),t.d(n,"getStringNoLocale",(function(){return Me})),t.d(n,"getStringNoLocaleAll",(function(){return We})),t.d(n,"getStringWithLocale",(function(){return Se})),t.d(n,"getStringWithLocaleAll",(function(){return Ne})),t.d(n,"getTerm",(function(){return Be})),t.d(n,"getTermAll",(function(){return ze})),t.d(n,"getThing",(function(){return nn})),t.d(n,"getThingAll",(function(){return tn})),t.d(n,"getUrl",(function(){return je})),t.d(n,"getUrlAll",(function(){return _e})),t.d(n,"hasAccessibleAcl",(function(){return nr})),t.d(n,"hasAcl",(function(){return Gt})),t.d(n,"hasFallbackAcl",(function(){return Vt})),t.d(n,"hasResourceAcl",(function(){return Bt})),t.d(n,"hasResourceInfo",(function(){return a})),t.d(n,"hasServerResourceInfo",(function(){return l})),t.d(n,"isContainer",(function(){return U})),t.d(n,"isPodOwner",(function(){return I})),t.d(n,"isRawData",(function(){return T})),t.d(n,"isThing",(function(){return an})),t.d(n,"mockContainerFrom",(function(){return kn})),t.d(n,"mockFetchError",(function(){return Wn})),t.d(n,"mockFileFrom",(function(){return Mn})),t.d(n,"mockSolidDatasetFrom",(function(){return Nn})),t.d(n,"mockThingFrom",(function(){return Rt})),t.d(n,"overwriteFile",(function(){return W})),t.d(n,"removeAll",(function(){return Yn})),t.d(n,"removeBoolean",(function(){return nt})),t.d(n,"removeDatetime",(function(){return tt})),t.d(n,"removeDecimal",(function(){return rt})),t.d(n,"removeInteger",(function(){return ot})),t.d(n,"removeIri",(function(){return et})),t.d(n,"removeLiteral",(function(){return at})),t.d(n,"removeNamedNode",(function(){return ut})),t.d(n,"removeStringNoLocale",(function(){return it})),t.d(n,"removeStringWithLocale",(function(){return ct})),t.d(n,"removeThing",(function(){return cn})),t.d(n,"removeUrl",(function(){return Kn})),t.d(n,"saveAclFor",(function(){return Kt})),t.d(n,"saveFileInContainer",(function(){return M})),t.d(n,"saveSolidDatasetAt",(function(){return mn})),t.d(n,"saveSolidDatasetInContainer",(function(){return Un})),t.d(n,"setAgentDefaultAccess",(function(){return lr})),t.d(n,"setAgentResourceAccess",(function(){return ir})),t.d(n,"setBoolean",(function(){return ft})),t.d(n,"setDatetime",(function(){return gt})),t.d(n,"setDecimal",(function(){return ht})),t.d(n,"setGroupDefaultAccess",(function(){return jr})),t.d(n,"setGroupResourceAccess",(function(){return Rr})),t.d(n,"setInteger",(function(){return pt})),t.d(n,"setIri",(function(){return dt})),t.d(n,"setLiteral",(function(){return yt})),t.d(n,"setNamedNode",(function(){return At})),t.d(n,"setPublicDefaultAccess",(function(){return Pr})),t.d(n,"setPublicResourceAccess",(function(){return Tr})),t.d(n,"setStringNoLocale",(function(){return bt})),t.d(n,"setStringWithLocale",(function(){return wt})),t.d(n,"setTerm",(function(){return mt})),t.d(n,"setThing",(function(){return rn})),t.d(n,"setUrl",(function(){return st})),t.d(n,"solidDatasetAsMarkdown",(function(){return Ln})),t.d(n,"thingAsMarkdown",(function(){return dn}));var r=t("x+K8"),o=t.n(r),c=t("0LTs"),i=t.n(c),u=t("XWHH");function a(e){return"object"===typeof e&&"object"===typeof e.internal_resourceInfo}function l(e){const n=e;return"object"===typeof n&&"object"===typeof n.internal_resourceInfo&&"object"===typeof n.internal_resourceInfo.linkedResources}function s(e){const n=e;return"object"===typeof n.internal_changeLog&&Array.isArray(n.internal_changeLog.additions)&&Array.isArray(n.internal_changeLog.deletions)}class d extends Error{}function f(e){return"string"===typeof e?e:e.value}const g=async(e,n)=>{let r;return r=t("XWHH"),await r(e,n)},h=i.a.dataset,{quad:p,literal:w,namedNode:b,blankNode:A}=i.a,y={quad:p,literal:w,namedNode:b,blankNode:A};function m(e){const n=h();for(const t of e)n.add(t);return n}function v(e){var n,t,r;const c=null!==(t=null===(n=e.headers.get("Content-Type"))||void 0===n?void 0:n.split(";"))&&void 0!==t?t:[],i=c.length>0&&["text/turtle","application/ld+json"].includes(c[0]),u={sourceIri:e.url,isRawData:!i,contentType:null!==(r=e.headers.get("Content-Type"))&&void 0!==r?r:void 0,linkedResources:{}},a=e.headers.get("Link");if(a){const e=o.a.parse(a),n=e.get("rel","acl");1===n.length&&(u.aclUrl=new URL(n[0].uri,u.sourceIri).href),u.linkedResources=e.refs.reduce((e,n)=>{var t,r;return null!==(t=e[r=n.rel])&&void 0!==t||(e[r]=[]),e[n.rel].push(new URL(n.uri,u.sourceIri).href),e},u.linkedResources)}const l=e.headers.get("WAC-Allow");return l&&(u.permissions=function(e){function n(e){const n=e.split(" ");return n.includes("write")?{read:n.includes("read"),append:!0,write:!0,control:n.includes("control")}:{read:n.includes("read"),append:n.includes("append"),write:!1,control:n.includes("control")}}function t(e,n){const t=e.split(",").map(e=>e.split("=")).filter(e=>2===e.length&&e[0].trim()===n);if(1!==t.length)return"";const r=t[0][1].trim();return'"'!==r.charAt(0)||'"'!==r.charAt(r.length-1)?"":r.substring(1,r.length-1)}return{user:n(t(e,"user")),public:n(t(e,"public"))}}(l)),u}function R(e){let n;return n="function"===typeof e.slice?e.slice():"function"===typeof e.match?m(e):Object.assign({},e),Object.assign(n,function(e){const n={};return Object.keys(e).forEach(t=>{const r=e[t];"object"===typeof r&&null!==r?"undefined"!==typeof r.constructor&&"Object"===r.constructor.name&&(n[t]=r):n[t]=r}),n}(e))}function j(e){return!e.ok}const O={fetch:g};async function _(e,n=O){const t=Object.assign(Object.assign({},O),n),r=await t.fetch(e,{method:"HEAD"});if(j(r))throw new E(`Fetching the metadata of the Resource at [${e}] failed: [${r.status}] [${r.statusText}].`,r);return{internal_resourceInfo:v(r)}}function U(e){return(a(e)?C(e):f(e)).endsWith("/")}function T(e){return e.internal_resourceInfo.isRawData}function P(e){var n;return null!==(n=e.internal_resourceInfo.contentType)&&void 0!==n?n:null}function C(e){return a(e)?e.internal_resourceInfo.sourceIri:null}const L=C;function $(e){var n;if(!l(e))return null;const t=null!==(n=e.internal_resourceInfo.linkedResources["http://www.w3.org/ns/solid/terms#podOwner"])&&void 0!==n?n:[];return 1===t.length?t[0]:null}function I(e,n){const t=$(n);return"string"!==typeof t?null:t===e}class E extends d{constructor(e,n){super(e),this.response=n}get statusCode(){return this.response.status}get statusText(){return this.response.statusText}}const D={fetch:g},S=["Slug","If-None-Match","Content-Type"];async function N(e,n=D){const t=Object.assign(Object.assign({},D),n),r=f(e),o=await t.fetch(r,t.init);if(j(o))throw new E(`Fetching the File failed: [${o.status}] [${o.statusText}].`,o);const c=v(o),i=await o.blob();return Object.assign(i,{internal_resourceInfo:c})}async function k(e,n=D){const t=Object.assign(Object.assign({},D),n),r=a(e)?f(L(e)):f(e),o=await t.fetch(r,Object.assign(Object.assign({},t.init),{method:"DELETE"}));if(j(o))throw new E(`Deleting the file at [${r}] failed: [${o.status}] [${o.statusText}].`,o)}async function M(e,n,t=D){const r=f(e),o=await x(r,n,"POST",t);if(j(o))throw new E(`Saving the file in [${e}] failed: [${o.status}] [${o.statusText}].`,o);const c=o.headers.get("Location");if(null===c)throw new Error("Could not determine the location of the newly saved file.");const i=new URL(c,new URL(r).origin).href,u=R(n),a={internal_resourceInfo:{isRawData:!0,sourceIri:i,contentType:q(n,t.contentType)}};return Object.assign(u,a)}async function W(e,n,t=D){const r=f(e),o=await x(r,n,"PUT",t);if(j(o))throw new E(`Overwriting the file at [${r}] failed: [${o.status}] [${o.statusText}].`,o);const c=R(n),i=v(o);return i.sourceIri=r,i.isRawData=!0,Object.assign(c,{internal_resourceInfo:i})}function F(e){if("undefined"===typeof e)return{};let n={};var t;return t=e,Array.isArray(t)?e.forEach(([e,t])=>{n[e]=t}):!function(e){return"function"===typeof e.forEach}(e)?n=e:e.forEach((e,t)=>{n[t]=e}),n}async function x(e,n,t,r){var o,c;const i=Object.assign(Object.assign({},D),r),u=F(null!==(c=null===(o=i.init)||void 0===o?void 0:o.headers)&&void 0!==c?c:{});if(a=u,S.some(e=>void 0!==a[e]))throw new Error(`No reserved header (${S.join(", ")}) should be set in the optional RequestInit.`);var a;void 0!==i.slug&&(u.Slug=i.slug),u["Content-Type"]=q(n,r.contentType);const l=f(e);return await i.fetch(l,Object.assign(Object.assign({},i.init),{headers:u,method:t,body:n}))}function q(e,n){if("string"===typeof n)return n;const t="object"===typeof e&&null!==e&&"string"===typeof e.type&&e.type.length>0?e.type:void 0;return null!==t&&void 0!==t?t:"application/octet-stream"}const G={Authorization:"http://www.w3.org/ns/auth/acl#Authorization",AuthenticatedAgent:"http://www.w3.org/ns/auth/acl#AuthenticatedAgent",accessTo:"http://www.w3.org/ns/auth/acl#accessTo",agent:"http://www.w3.org/ns/auth/acl#agent",agentGroup:"http://www.w3.org/ns/auth/acl#agentGroup",agentClass:"http://www.w3.org/ns/auth/acl#agentClass",default:"http://www.w3.org/ns/auth/acl#default",defaultForNew:"http://www.w3.org/ns/auth/acl#defaultForNew",mode:"http://www.w3.org/ns/auth/acl#mode",origin:"http://www.w3.org/ns/auth/acl#origin"},B={type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"},z={BasicContainer:"http://www.w3.org/ns/ldp#BasicContainer",Container:"http://www.w3.org/ns/ldp#Container",Resource:"http://www.w3.org/ns/ldp#Resource",contains:"http://www.w3.org/ns/ldp#contains"},X={Agent:"http://xmlns.com/foaf/0.1/Agent"},H={Policy:"http://www.w3.org/ns/solid/acp#Policy",AccessControl:"http://www.w3.org/ns/solid/acp#AccessControl",Read:"http://www.w3.org/ns/solid/acp#Read",Append:"http://www.w3.org/ns/solid/acp#Append",Write:"http://www.w3.org/ns/solid/acp#Write",Rule:"http://www.w3.org/ns/solid/acp#Rule",accessControl:"http://www.w3.org/ns/solid/acp#accessControl",apply:"http://www.w3.org/ns/solid/acp#apply",applyMembers:"http://www.w3.org/ns/solid/acp#applyMembers",allow:"http://www.w3.org/ns/solid/acp#allow",deny:"http://www.w3.org/ns/solid/acp#deny",allOf:"http://www.w3.org/ns/solid/acp#allOf",anyOf:"http://www.w3.org/ns/solid/acp#anyOf",noneOf:"http://www.w3.org/ns/solid/acp#noneOf",access:"http://www.w3.org/ns/solid/acp#access",accessMembers:"http://www.w3.org/ns/solid/acp#accessMembers",agent:"http://www.w3.org/ns/solid/acp#agent",group:"http://www.w3.org/ns/solid/acp#group",client:"http://www.w3.org/ns/solid/acp#client",PublicAgent:"http://www.w3.org/ns/solid/acp#PublicAgent",AuthenticatedAgent:"http://www.w3.org/ns/solid/acp#AuthenticatedAgent",CreatorAgent:"http://www.w3.org/ns/solid/acp#CreatorAgent"},J={PublicOidcClient:"http://www.w3.org/ns/solid/terms#PublicOidcClient"};async function V(e){const n=new((await Z()).Writer)({format:"text/turtle"}),t=e.map(e=>y.quad(e.subject,e.predicate,e.object,void 0));n.addQuads(t);const r=new Promise((e,t)=>{n.end((n,r)=>{if(n)return t(n);e(r)})});return await r}async function Z(){const e=await t.e(14).then(t.bind(null,"o3Ww"));return"undefined"!==typeof e.default?e.default:e}const Q={boolean:"http://www.w3.org/2001/XMLSchema#boolean",dateTime:"http://www.w3.org/2001/XMLSchema#dateTime",decimal:"http://www.w3.org/2001/XMLSchema#decimal",integer:"http://www.w3.org/2001/XMLSchema#integer",string:"http://www.w3.org/2001/XMLSchema#string",langString:"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"};function Y(e){return e?"true":"false"}function K(e){return"true"===e||"1"===e||"false"!==e&&"0"!==e&&null}function ee(e){return e.toISOString()}function ne(e){if(!/-?\d{4,}-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(Z|(\+|-)\d\d:\d\d)/.test(e))return null;const[n,t]=e.split("T"),[r,o]="-"===n.charAt(0)?[-1,n.substring(1)]:[1,n],[c,i,u]=o.split("-"),a=Number.parseInt(c,10)*r,l=Number.parseInt(i,10)-1,s=Number.parseInt(u,10),[d,f]=function(e){if(e.endsWith("Z"))return[e.substring(0,e.length-1),"Z"];const n=e.split("+"),t=e.split("-");return n.length>t.length?[n[0],"+"+n[1]]:[t[0],"-"+t[1]]}(t),[g,h]=function(e){if("Z"===e)return[0,0];const n="+"===e.charAt(0)?1:-1,[t,r]=e.substring(1).split(":"),o=Number.parseInt(t,10),c=Number.parseInt(r,10);return[o*n,c*n]}(f),[p,w,b]=d.split(":"),A=Number.parseInt(p,10)+g,y=Number.parseInt(w,10)+h,[m,v]=b.split("."),R=Number.parseInt(m,10),j=v?Number.parseInt(v,10):0,O=new Date(Date.UTC(a,l,s,A,y,R,j));return a>=0&&a<100&&O.setUTCFullYear(O.getUTCFullYear()-1900),O}function te(e){return e.toString()}function re(e){const n=Number.parseFloat(e);return Number.isNaN(n)?null:n}function oe(e){return e.toString()}function ce(e){const n=Number.parseInt(e,10);return Number.isNaN(n)?null:n}function ie(e){return e.toLowerCase()}function ue(e){return le(e)&&"NamedNode"===e.termType}function ae(e){return le(e)&&"Literal"===e.termType}function le(e){return null!==e&&"object"===typeof e&&"string"===typeof e.termType&&"string"===typeof e.value&&"function"===typeof e.equals}function se(e){return le(e)&&"BlankNode"===e.termType&&"string"===typeof e.internal_name}function de(e){const n=f(e);if("function"!==typeof URL)return!0;try{new URL(n)}catch(t){return!1}return!0}function fe(e){if(!de(e))throw new we(e);return ue(e)?e:y.namedNode(e)}function ge(e,n,t={}){if(ue(e)&&ue(n))return e.equals(n);if(se(e)&&se(n))return e.internal_name===n.internal_name;if("undefined"===typeof t.resourceIri)return!1;const r=ue(e)?e:he(e,t.resourceIri),o=ue(n)?n:he(n,t.resourceIri);return r.equals(o)}function he(e,n){return y.namedNode(pe(e.internal_name,n))}function pe(e,n){if("function"!==typeof URL)throw new Error("The URL interface is not available, so an IRI cannot be determined.");const t=new URL(n);return t.hash=e,t.href}class we extends d{constructor(e){const n=ue(e)?e.value:e;super(`Expected a valid URL, but received: [${n}].`),this.receivedValue=n}}function be(e){var n,t,r,o,c,i,u,a;if(ue(e))return`<${e.value}> (URL)`;if(ae(e)){if(!ue(e.datatype))return`[${e.value}] (RDF/JS Literal of unknown type)`;let l;switch(e.datatype.value){case Q.boolean:return l=null!==(t=null===(n=K(e.value))||void 0===n?void 0:n.valueOf())&&void 0!==t?t:`Invalid data: \`${e.value}\``,l+" (boolean)";case Q.dateTime:return l=null!==(o=null===(r=ne(e.value))||void 0===r?void 0:r.toUTCString())&&void 0!==o?o:`Invalid data: \`${e.value}\``,l+" (datetime)";case Q.decimal:return l=null!==(i=null===(c=re(e.value))||void 0===c?void 0:c.toString())&&void 0!==i?i:`Invalid data: \`${e.value}\``,l+" (decimal)";case Q.integer:return l=null!==(a=null===(u=ce(e.value))||void 0===u?void 0:u.toString())&&void 0!==a?a:`Invalid data: \`${e.value}\``,l+" (integer)";case Q.langString:return`"${e.value}" (${e.language} string)`;case Q.string:return`"${e.value}" (string)`;default:return`[${e.value}] (RDF/JS Literal of type: \`${e.datatype.value}\`)`}}return se(e)?`<#${e.internal_name}> (URL)`:"BlankNode"===e.termType?`[${e.value}] (RDF/JS BlankNode)`:"Quad"===e.termType?"??? (nested RDF* Quad)":"Variable"===e.termType?`?${e.value} (RDF/JS Variable)`:e}function Ae(e){return ue(e)||se(e)?e:"string"===typeof e?fe(e):fn(e)?e.internal_localSubject:fe(ln(e))}function ye(e){const n=m(e);return fn(e)?(n.internal_localSubject=e.internal_localSubject,n):(n.internal_url=e.internal_url,n)}function me(e,n){const t=function(e,n){const t=h();for(const r of e)n(r)&&t.add(r);return t}(e,n);return fn(e)?(t.internal_localSubject=e.internal_localSubject,t):(t.internal_url=e.internal_url,t)}function ve(e){if(!an(e))throw new gn(e)}function Re(e){return s(e)?e:Object.assign(R(e),{internal_changeLog:{additions:[],deletions:[]}})}function je(e,n){ve(e);const t=Xe(e,Je(n));return null===t?null:t.object.value}const Oe=je;function _e(e,n){return ve(e),He(e,Je(n)).map(e=>e.object.value)}const Ue=_e;function Te(e,n){ve(e);const t=Ke(e,n,Q.boolean);return null===t?null:K(t)}function Pe(e,n){return ve(e),en(e,n,Q.boolean).map(K).filter(e=>null!==e)}function Ce(e,n){ve(e);const t=Ke(e,n,Q.dateTime);return null===t?null:ne(t)}function Le(e,n){return ve(e),en(e,n,Q.dateTime).map(ne).filter(e=>null!==e)}function $e(e,n){ve(e);const t=Ke(e,n,Q.decimal);return null===t?null:re(t)}function Ie(e,n){return ve(e),en(e,n,Q.decimal).map(e=>re(e)).filter(e=>null!==e)}function Ee(e,n){ve(e);const t=Ke(e,n,Q.integer);return null===t?null:ce(t)}function De(e,n){return ve(e),en(e,n,Q.integer).map(e=>ce(e)).filter(e=>null!==e)}function Se(e,n,t){ve(e);const r=Xe(e,Ye(n,t));return null===r?null:r.object.value}function Ne(e,n,t){return ve(e),He(e,Ye(n,t)).map(e=>e.object.value)}function ke(e,n){ve(e);const t=He(e,Ve(n)),r=new Map;return t.map(e=>{if(e.object.datatype.value===Q.langString){const n=e.object.language,t=r.get(n);t?r.set(n,[...t,e.object.value]):r.set(n,[e.object.value])}}),r}function Me(e,n){return ve(e),Ke(e,n,Q.string)}function We(e,n){return ve(e),en(e,n,Q.string)}function Fe(e,n){ve(e);const t=Xe(e,Je(n));return null===t?null:t.object}function xe(e,n){return ve(e),He(e,Je(n)).map(e=>e.object)}function qe(e,n){ve(e);const t=Xe(e,Ve(n));return null===t?null:t.object}function Ge(e,n){return ve(e),He(e,Ve(n)).map(e=>e.object)}function Be(e,n){ve(e);const t=Xe(e,Ze(n));return null===t?null:t.object}function ze(e,n){return ve(e),He(e,Ze(n)).map(e=>e.object)}function Xe(e,n){for(const t of e)if(n(t))return t;return null}function He(e,n){const t=[];for(const r of e)n(r)&&t.push(r);return t}function Je(e){if(!de(e))throw new hn(e);const n=fe(e);return function(e){return n.equals(e.predicate)&&ue(e.object)}}function Ve(e){if(!de(e))throw new hn(e);const n=fe(e);return function(e){return n.equals(e.predicate)&&ae(e.object)}}function Ze(e){if(!de(e))throw new hn(e);const n=fe(e);return function(e){return n.equals(e.predicate)&&le(e.object)}}function Qe(e,n){if(!de(e))throw new hn(e);const t=fe(e);return function(e){return t.equals(e.predicate)&&ae(e.object)&&e.object.datatype.value===n}}function Ye(e,n){if(!de(e))throw new hn(e);const t=fe(e);return function(e){return t.equals(e.predicate)&&ae(e.object)&&e.object.datatype.value===Q.langString&&e.object.language.toLowerCase()===n.toLowerCase()}}function Ke(e,n,t){const r=Xe(e,Qe(n,t));return null===r?null:r.object.value}function en(e,n,t){return He(e,Qe(n,t)).map(e=>e.object.value)}function nn(e,n,t={}){if(!se(n)&&!de(n))throw new wn(n);const r=se(n)?n:fe(n),o=t.scope?fe(t.scope):null,c=e.match(r,null,null,o);if(0===c.size)return null;if(se(r)){return Object.assign(c,{internal_localSubject:r})}return Object.assign(c,{internal_url:r.value})}function tn(e,n={}){const t=new Array;for(const r of e){const e=r.subject;ue(e)&&!t.some(n=>ge(n,e))&&t.push(e),se(e)&&!t.some(n=>ge(n,e))&&t.push(e)}return t.map(t=>nn(e,t,n))}function rn(e,n){const t=cn(e,n);t.internal_changeLog={additions:[...t.internal_changeLog.additions],deletions:[...t.internal_changeLog.deletions]};for(const r of n){t.add(r);const e=t.internal_changeLog.deletions.find(e=>on(r,e));"undefined"!==typeof e?t.internal_changeLog.deletions=t.internal_changeLog.deletions.filter(n=>n!==e):t.internal_changeLog.additions.push(r)}return t}function on(e,n){return e.subject.equals(n.subject)&&n.predicate.equals(n.predicate)&&(e.object.equals(n.object)||"BlankNode"===e.object.termType&&"BlankNode"===n.object.termType)}function cn(e,n){const t=Re(R(e));t.internal_changeLog={additions:[...t.internal_changeLog.additions],deletions:[...t.internal_changeLog.deletions]};const r=a(t)?C(t):void 0,o=Ae(n);return Array.from(t).forEach(e=>{(ue(e.subject)||se(e.subject))&&ge(o,e.subject,{resourceIri:r})&&(t.delete(e),t.internal_changeLog.additions.includes(e)?t.internal_changeLog.additions=t.internal_changeLog.additions.filter(n=>n!==e):t.internal_changeLog.deletions.push(e))}),t}function un(e={}){var n;if("undefined"!==typeof e.url){const n=e.url;if(!de(n))throw new wn(n);return Object.assign(h(),{internal_url:n})}const t=function(e){return Object.assign(y.blankNode(),{internal_name:e})}(null!==(n=e.name)&&void 0!==n?n:bn());return Object.assign(h(),{internal_localSubject:t})}function an(e){return function(e){return"object"===typeof e&&null!==e&&"number"===typeof e.size&&"function"===typeof e.add&&"function"===typeof e.delete&&"function"===typeof e.has&&"function"===typeof e.match&&Array.from(e).length===e.size}(e)&&(fn(e)||"string"===typeof e.internal_url)}function ln(e,n){if(fn(e)){if("undefined"===typeof n)throw new Error("The URL of a Thing that has not been persisted cannot be determined without a base URL.");return pe(e.internal_localSubject.internal_name,n)}return e.internal_url}const sn=ln;function dn(e){let n="";fn(e)?n+=`## Thing (no URL yet \u2014 identifier: \`#${e.internal_localSubject.internal_name}\`)\n`:n+=`## Thing: ${e.internal_url}\n`;const t=Array.from(e);if(0===t.length)n+="\n<empty>\n";else{const r=new Set(t.map(e=>e.predicate.value));for(const t of r){n+=`\nProperty: ${t}\n`,ze(e,t).forEach(e=>{n+=`- ${be(e)}\n`})}}return n}function fn(e){var n;return"string"===typeof(null===(n=e.internal_localSubject)||void 0===n?void 0:n.internal_name)&&"undefined"===typeof e.internal_url}class gn extends d{constructor(e){super(`Expected a Thing, but received: [${e}].`),this.receivedValue=e}}class hn extends d{constructor(e){const n=ue(e)?e.value:e;super(`Expected a valid URL to identify a property, but received: [${n}].`),this.receivedProperty=n}}class pn extends d{constructor(e){const n=ue(e)?e.value:e;super(`Expected a valid URL value, but received: [${n}].`),this.receivedValue=n}}class wn extends d{constructor(e){const n=ue(e)?e.value:e;super(`Expected a valid URL to identify a Thing, but received: [${n}].`),this.receivedValue=n}}const bn=()=>Date.now().toString()+Math.random().toString().substring("0.".length);function An(){return h()}async function yn(e,n=O){e=f(e);const t=Object.assign(Object.assign({},O),n),r=await t.fetch(e,{headers:{Accept:"text/turtle"}});if(j(r))throw new E(`Fetching the Resource at [${e}] failed: [${r.status}] [${r.statusText}].`,r);const o=await r.text(),c=await async function(e,n){const t=new((await Z()).Parser)({format:"text/turtle",baseIRI:n});return new Promise((n,r)=>{const o=[];t.parse(e,(e,t,c)=>{if(e)return r(e);t?o.push(t):n(o)})})}(o,e),i=h();c.forEach(e=>i.add(e));const u=v(r);return Object.assign(i,{internal_resourceInfo:u})}async function mn(e,n,t=O){e=f(e);const r=Object.assign(Object.assign({},O),t),o=Re(n),c=_n(o,e)?await async function(e){return{method:"PATCH",body:`${e.internal_changeLog.deletions.length>0?`DELETE DATA {${(await V(e.internal_changeLog.deletions.map(In))).trim()}};`:""} ${e.internal_changeLog.additions.length>0?`INSERT DATA {${(await V(e.internal_changeLog.additions.map(In))).trim()}};`:""}`,headers:{"Content-Type":"application/sparql-update"}}}(o):await async function(e){return{method:"PUT",body:await V(Array.from(e).map(In)),headers:{"Content-Type":"text/turtle","If-None-Match":"*",Link:`<${z.Resource}>; rel="type"`}}}(o),i=await r.fetch(e,c);if(j(i)){const n=_n(o,e)?"The changes that were sent to the Pod are listed below.\n\n"+$n(o):"The SolidDataset that was sent to the Pod is listed below.\n\n"+Ln(o);throw new E(`Storing the Resource at [${e}] failed: [${i.status}] [${i.statusText}].\n\n`+n,i)}const u=Object.assign(Object.assign({},v(i)),{sourceIri:e,isRawData:!1});return Dn(Object.assign(R(o),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:u}))}async function vn(e,n=O){const t=Object.assign(Object.assign({},O),n),r=a(e)?f(C(e)):f(e),o=await t.fetch(r,{method:"DELETE"});if(j(o))throw new E(`Deleting the SolidDataset at [${r}] failed: [${o.status}] [${o.statusText}].`,o)}async function Rn(e,n=O){e=(e=f(e)).endsWith("/")?e:e+"/";const t=Object.assign(Object.assign({},O),n),r=await t.fetch(e,{method:"PUT",headers:{Accept:"text/turtle","Content-Type":"text/turtle","If-None-Match":"*",Link:`<${z.BasicContainer}>; rel="type"`}});if(j(r)){if(409===r.status&&"Conflict"===r.statusText&&(await r.text()).trim()===jn)return On(e,n);throw new E(`Creating the empty Container at [${e}] failed: [${r.status}] [${r.statusText}].`,r)}const o=v(r);return Object.assign(h(),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:o})}const jn="Can't write file: PUT not supported on containers, use POST instead",On=async(e,n)=>{e=f(e);const t=Object.assign(Object.assign({},O),n);let r;try{r=await _(e,n)}catch(u){if(!(u instanceof E)||404!==u.statusCode)throw u}if("undefined"!==typeof r)throw new Error(`The Container at [${e}] already exists, and therefore cannot be created again.`);const o=e+".dummy",c=await t.fetch(o,{method:"PUT",headers:{Accept:"text/turtle","Content-Type":"text/turtle"}});if(j(c))throw new E(`Creating the empty Container at [${e}] failed: [${c.status}] [${c.statusText}].`,c);await t.fetch(o,{method:"DELETE"});const i=v(await t.fetch(e,{method:"HEAD"}));return Object.assign(h(),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:i})};function _n(e,n){return s(e)&&a(e)&&"string"===typeof e.internal_resourceInfo.sourceIri&&e.internal_resourceInfo.sourceIri===n}async function Un(e,n,t=O){const r=Object.assign(Object.assign({},O),t);e=f(e);const o=await V(Array.from(n).map(In)),c={"Content-Type":"text/turtle",Link:`<${z.Resource}>; rel="type"`};t.slugSuggestion&&(c.slug=t.slugSuggestion);const i=await r.fetch(e,{method:"POST",body:o,headers:c});if(j(i))throw new E(`Storing the Resource in the Container at [${e}] failed: [${i.status}] [${i.statusText}].\n\n`+"The SolidDataset that was sent to the Pod is listed below.\n\n"+Ln(n),i);const u=i.headers.get("Location");if(null===u)throw new Error("Could not determine the location of the newly saved SolidDataset.");const a={internal_resourceInfo:{isRawData:!1,sourceIri:new URL(u,new URL(e).origin).href}};return Dn(Object.assign(R(n),a))}async function Tn(e,n=O){e=f(e);const t=Object.assign(Object.assign({},O),n),r={"Content-Type":"text/turtle",Link:`<${z.BasicContainer}>; rel="type"`};n.slugSuggestion&&(r.slug=n.slugSuggestion);const o=await t.fetch(e,{method:"POST",headers:r});if(j(o))throw new E(`Creating an empty Container in the Container at [${e}] failed: [${o.status}] [${o.statusText}].`,o);const c=o.headers.get("Location");if(null===c)throw new Error("Could not determine the location of the newly created Container.");const i={internal_resourceInfo:{isRawData:!1,sourceIri:new URL(c,new URL(e).origin).href}};return Object.assign(h(),i)}async function Pn(e,n=O){const t=a(e)?f(C(e)):f(e);if(!U(e))throw new Error(`You're trying to delete the Container at [${t}], but Container URLs should end in a \`/\`. Are you sure this is a Container?`);const r=Object.assign(Object.assign({},O),n),o=await r.fetch(t,{method:"DELETE"});if(j(o))throw new E(`Deleting the Container at [${t}] failed: [${o.status}] [${o.statusText}].`,o)}function Cn(e){const n=nn(e,C(e));return null!==n?Ue(n,z.contains):[]}function Ln(e){let n="";a(e)?n+=`# SolidDataset: ${e.internal_resourceInfo.sourceIri}\n`:n+="# SolidDataset (no URL yet)\n";const t=tn(e);return 0===t.length?n+="\n<empty>\n":t.forEach(t=>{n+="\n"+dn(t),s(e)&&(n+="\n"+function(e,n){const t=Ae(n),r=e.internal_changeLog.additions.reduce((e,n)=>n.subject.equals(t)?e+1:e,0),o=e.internal_changeLog.deletions.reduce((e,n)=>n.subject.equals(t)?e+1:e,0);return`(${1===r?"1 new value added":r+" new values added"} / ${1===o?"1 value removed":o+" values removed"})`}(e,t)+"\n")}),n}function $n(e){if(!a(e))return"This is a newly initialized SolidDataset, so there is no source to compare it to.";if(!s(e)||0===e.internal_changeLog.additions.length&&0===e.internal_changeLog.deletions.length)return`## Changes compared to ${C(e)}\n\n`+`This SolidDataset has not been modified since it was fetched from ${C(e)}.\n`;let n=`## Changes compared to ${C(e)}\n`;const t=function(e){const n={};return e.internal_changeLog.deletions.forEach(t=>{var r,o,c;const i=se(t.subject)?he(t.subject,C(e)):t.subject;if(!ue(i)||!ue(t.predicate))return;const u=f(i),a=f(t.predicate);null!==(r=n[u])&&void 0!==r||(n[u]={}),null!==(o=(c=n[u])[a])&&void 0!==o||(c[a]={added:[],deleted:[]}),n[u][a].deleted.push(t.object)}),e.internal_changeLog.additions.forEach(t=>{var r,o,c;const i=se(t.subject)?he(t.subject,C(e)):t.subject;if(!ue(i)||!ue(t.predicate))return;const u=f(i),a=f(t.predicate);null!==(r=n[u])&&void 0!==r||(n[u]={}),null!==(o=(c=n[u])[a])&&void 0!==o||(c[a]={added:[],deleted:[]}),n[u][a].added.push(t.object)}),n}(e);return Object.keys(t).forEach(e=>{n+=`\n### Thing: ${e}\n`;const r=t[e];Object.keys(r).forEach(e=>{n+=`\nProperty: ${e}\n`;const t=r[e].deleted,o=r[e].added;t.length>0&&(n+="- Removed:\n",t.forEach(e=>n+=`  - ${be(e)}\n`)),o.length>0&&(n+="- Added:\n",o.forEach(e=>n+=`  - ${be(e)}\n`))})}),n}function In(e){const n=se(e.subject)?En(e.subject):e.subject,t=se(e.object)?En(e.object):e.object;return Object.assign(Object.assign({},e),{subject:n,object:t})}function En(e){return y.namedNode("#"+e.internal_name)}function Dn(e){const n=C(e);return Array.from(e).forEach(t=>{const r=function(e,n){const t=se(e.subject)?he(e.subject,n):e.subject,r=se(e.object)?he(e.object,n):e.object;return Object.assign(Object.assign({},e),{subject:t,object:r})}(t,n);e.delete(t),e.add(r)}),e}const{Response:Sn}=u;function Nn(e){const n=An();return Object.assign(n,{internal_resourceInfo:{sourceIri:f(e),isRawData:!1,contentType:"text/turtle",linkedResources:{}}})}function kn(e){const n=f(e);if(!n.endsWith("/"))throw new Error("A Container's URL should end in a slash. Please update your tests.");return Nn(n)}function Mn(e,n){const t=new Blob;return Object.assign(t,{internal_resourceInfo:{sourceIri:f(e),isRawData:!0,contentType:null===n||void 0===n?void 0:n.contentType,linkedResources:{}}})}function Wn(e,n=404){const t=new Sn(void 0,{status:n});return new E(`Fetching the Resource at [${e}] failed: [${t.status}] [${t.statusText}].`,t)}const Fn=(e,n,t)=>{if(ve(e),!de(n))throw new hn(n);const r=fe(n),o=ye(e);if(!an(t)&&!de(t))throw new pn(t);return o.add(y.quad(Ae(o),r,Ae(t))),o},xn=Fn,qn=(e,n,t)=>(ve(e),Qn(e,n,Y(t),Q.boolean)),Gn=(e,n,t)=>(ve(e),Qn(e,n,ee(t),Q.dateTime)),Bn=(e,n,t)=>(ve(e),Qn(e,n,te(t),Q.decimal)),zn=(e,n,t)=>(ve(e),Qn(e,n,oe(t),Q.integer));function Xn(e,n,t,r){return ve(e),Vn(e,n,y.literal(t,ie(r)))}const Hn=(e,n,t)=>(ve(e),Qn(e,n,t,Q.string));function Jn(e,n,t){return ve(e),Zn(e,n,t)}function Vn(e,n,t){return ve(e),Zn(e,n,t)}function Zn(e,n,t){if(ve(e),!de(n))throw new hn(n);const r=fe(n),o=ye(e);return o.add(y.quad(Ae(o),r,t)),o}function Qn(e,n,t,r){return Vn(e,n,y.literal(t,y.namedNode(r)))}function Yn(e,n){if(ve(e),!de(n))throw new hn(n);const t=fe(n);return me(e,e=>!e.predicate.equals(t))}const Kn=(e,n,t)=>{if(ve(e),!de(n))throw new hn(n);const r=fe(n);if(!an(t)&&!de(t))throw new pn(t);const o=ue(t)?t:fe("string"===typeof t?t:sn(t));return me(e,e=>!e.predicate.equals(r)||!ue(e.object)||!e.object.equals(o))},et=Kn,nt=(e,n,t)=>(ve(e),lt(e,n,Q.boolean,e=>K(e)===t)),tt=(e,n,t)=>(ve(e),lt(e,n,Q.dateTime,e=>{var n;return(null===(n=ne(e))||void 0===n?void 0:n.getTime())===t.getTime()})),rt=(e,n,t)=>(ve(e),lt(e,n,Q.decimal,e=>re(e)===t)),ot=(e,n,t)=>(ve(e),lt(e,n,Q.integer,e=>ce(e)===t));function ct(e,n,t,r){return ve(e),at(e,n,y.literal(t,ie(r)))}const it=(e,n,t)=>(ve(e),lt(e,n,Q.string,e=>e===t));function ut(e,n,t){if(ve(e),!de(n))throw new hn(n);const r=fe(n);return me(e,e=>!e.predicate.equals(r)||!ue(e.object)||!e.object.equals(t))}function at(e,n,t){if(ve(e),!de(n))throw new hn(n);const r=fe(n);return me(e,e=>!e.predicate.equals(r)||!ae(e.object)||!e.object.equals(t))}function lt(e,n,t,r){if(!de(n))throw new hn(n);const o=fe(n);return me(e,e=>!(e.predicate.equals(o)&&ae(e.object)&&e.object.datatype.equals(y.namedNode(t))&&r(e.object.value)))}const st=(e,n,t)=>{if(ve(e),!de(n))throw new hn(n);if(!an(t)&&!de(t))throw new pn(t);const r=Yn(e,n),o=fe(n);return r.add(y.quad(Ae(r),o,Ae(t))),r},dt=st,ft=(e,n,t)=>(ve(e),vt(e,n,Y(t),Q.boolean)),gt=(e,n,t)=>(ve(e),vt(e,n,ee(t),Q.dateTime)),ht=(e,n,t)=>(ve(e),vt(e,n,te(t),Q.decimal)),pt=(e,n,t)=>(ve(e),vt(e,n,oe(t),Q.integer));function wt(e,n,t,r){return ve(e),yt(e,n,y.literal(t,ie(r)))}const bt=(e,n,t)=>(ve(e),vt(e,n,t,Q.string));function At(e,n,t){return ve(e),mt(e,n,t)}function yt(e,n,t){return ve(e),mt(e,n,t)}function mt(e,n,t){if(ve(e),!de(n))throw new hn(n);const r=Yn(e,n),o=fe(n);return r.add(y.quad(Ae(r),o,t)),r}function vt(e,n,t,r){return yt(e,n,y.literal(t,y.namedNode(r)))}function Rt(e){return Object.assign(h(),{internal_url:f(e)})}async function jt(e,n=O){if(!nr(e))return{resourceAcl:null,fallbackAcl:null};const t=await Ot(e,n);return null===t?{resourceAcl:null,fallbackAcl:await _t(e,n)}:{resourceAcl:t,fallbackAcl:null}}async function Ot(e,n=O){if(!nr(e))return null;try{const t=await yn(e.internal_resourceInfo.aclUrl,n);return Object.assign(t,{internal_accessTo:C(e)})}catch(t){return null}}async function _t(e,n=O){const t=new URL(C(e)),r=t.pathname;if("/"===r)return null;const o=Ut(r),c=new URL(o,t.origin).href,i=await _(c,n);if(!nr(i))return null;const u=await Ot(i,n);return null===u?_t(i,n):u}function Ut(e){const n="/"===e.substring(e.length-1)?e.substring(0,e.length-1):e;return e.substring(0,n.lastIndexOf("/"))+"/"}function Tt(e){return tn(e).filter(Pt)}function Pt(e){return Ue(e,B.type).includes(G.Authorization)}function Ct(e,n){return e.filter(e=>(function(e,n){return Ue(e,G.accessTo).includes(n)})(e,n))}function Lt(e,n){return e.filter(e=>(function(e,n){return Ue(e,G.default).includes(n)||Ue(e,G.defaultForNew).includes(n)})(e,n))}function $t(e){const n=Ue(e,G.mode);return n.includes(Dt.write)?{read:n.includes(Dt.read),append:!0,write:!0,control:n.includes(Dt.control)}:{read:n.includes(Dt.read),append:n.includes(Dt.append),write:!1,control:n.includes(Dt.control)}}function It(e){return e.reduce((e,n)=>{return e.write||n.write?{read:e.read||n.read,append:!0,write:!0,control:e.control||n.control}:{read:e.read||n.read,append:e.append||n.append,write:!1,control:e.control||n.control}},{read:!1,append:!1,write:!1,control:!1})}function Et(e){return!Array.from(e).some(e=>!function(e){const n=e.predicate,t=e.object;if(n.equals(y.namedNode(B.type))&&t.equals(y.namedNode(G.Authorization)))return!0;if(n.equals(y.namedNode(G.accessTo))||n.equals(y.namedNode(G.default))||n.equals(y.namedNode(G.defaultForNew)))return!0;if(n.equals(y.namedNode(G.mode))&&Object.values(Dt).some(e=>t.equals(y.namedNode(e))))return!0;if(n.equals(y.namedNode(G.agent))||n.equals(y.namedNode(G.agentGroup))||n.equals(y.namedNode(G.agentClass)))return!0;if(n.equals(y.namedNode(G.origin)))return!0;return!1}(e))&&(null===Oe(e,G.accessTo)&&null===Oe(e,G.default)&&null===Oe(e,G.defaultForNew)||(null===Oe(e,G.mode)||null===Oe(e,G.agent)&&null===Oe(e,G.agentGroup)&&null===Oe(e,G.agentClass)))}const Dt={read:"http://www.w3.org/ns/auth/acl#Read",append:"http://www.w3.org/ns/auth/acl#Append",write:"http://www.w3.org/ns/auth/acl#Write",control:"http://www.w3.org/ns/auth/acl#Control"};function St(e,n,t){return e.filter(e=>Ue(e,t).includes(n))}function Nt(e,n){const t={};return e.forEach(e=>{const r=Ue(e,n),o=$t(e);r.forEach(e=>{t[e]="undefined"===typeof t[e]?o:It([t[e],o])})}),t}function kt(e){let n=un();return n=dt(n,B.type,G.Authorization),e.read&&(n=xn(n,G.mode,Dt.read)),e.append&&!e.write&&(n=xn(n,G.mode,Dt.append)),e.write&&(n=xn(n,G.mode,Dt.write)),e.control&&(n=xn(n,G.mode,Dt.control)),n}function Mt(e,n){return Object.assign(e,{internal_acl:n})}const Wt=[G.agent,G.agentClass,G.agentGroup,G.origin];function Ft(e,n,t,r,o){if(!Ue(e,t).includes(n)){return[e,kt({read:!1,append:!1,write:!1,control:!1})]}const c=et(e,t,n);let i=function(e){let n=un();function t(e,n,t){return Ue(e,t).reduce((e,n)=>xn(e,t,n),n)}return n=dt(n,B.type,G.Authorization),n=t(e,n,G.accessTo),n=t(e,n,G.default),n=t(e,n,G.defaultForNew),n=t(e,n,G.agent),n=t(e,n,G.agentGroup),n=t(e,n,G.agentClass),n=t(e,n,G.origin),n=t(e,n,G.mode),n}(e);return i=et(i,"resource"===o?G.accessTo:G.default,r),"default"===o&&(i=et(i,G.defaultForNew,r)),i=dt(i,t,n),Wt.filter(e=>e!==t).forEach(e=>{i=Yn(i,e)}),[c,i]}function xt(e,n,t,r,o){let c=e;tn(e).forEach(n=>{const[i,u]=Ft(n,o,t,e.internal_accessTo,r);c=rn(c,i),c=rn(c,u)});let i=kt(n);return i=dt(i,"resource"===r?G.accessTo:G.default,e.internal_accessTo),i=dt(i,t,o),function(e){return Tt(e).filter(Et).reduce(cn,e)}(rn(c,i))}function qt(e,n){return Mt(e,{resourceAcl:n,fallbackAcl:null})}function Gt(e){return"object"===typeof e.internal_acl}function Bt(e){return null!==e.internal_acl.resourceAcl&&C(e)===e.internal_acl.resourceAcl.internal_accessTo&&e.internal_resourceInfo.aclUrl===C(e.internal_acl.resourceAcl)}async function zt(e,n=O){const t=await yn(e,n);return Mt(t,await jt(t,n))}async function Xt(e,n=O){const t=await N(e,n);return Mt(t,await jt(t,n))}async function Ht(e,n=O){const t=await _(e,n);return Mt(t,await jt(t,n))}function Jt(e){return Bt(e)?e.internal_acl.resourceAcl:null}function Vt(e){return null!==e.internal_acl.fallbackAcl}function Zt(e){return Vt(e)?e.internal_acl.fallbackAcl:null}function Qt(e){return Object.assign(h(),{internal_accessTo:C(e),internal_resourceInfo:{sourceIri:e.internal_resourceInfo.aclUrl,isRawData:!1,linkedResources:{}}})}function Yt(e){const n=Qt(e);return Lt(Tt(e.internal_acl.fallbackAcl),e.internal_acl.fallbackAcl.internal_accessTo).map(n=>(n=Yn(n,G.default),n=Yn(n,G.defaultForNew),n=dt(n,G.accessTo,C(e)),n=dt(n,G.default,C(e)))).reduce(rn,n)}async function Kt(e,n,t=O){if(!nr(e))throw new Error(`Could not determine the location of the ACL for the Resource at [${C(e)}]; possibly the current user does not have Control access to that Resource. Try calling \`hasAccessibleAcl()\` before calling \`saveAclFor()\`.`);const r=await mn(e.internal_resourceInfo.aclUrl,n,t);return Object.assign(r,{internal_accessTo:C(e)})}async function er(e,n=O){const t=Object.assign(Object.assign({},O),n),r=await t.fetch(e.internal_resourceInfo.aclUrl,{method:"DELETE"});if(!r.ok)throw new Error(`Deleting the ACL of the Resource at [${C(e)}] failed: [${r.status}] [${r.statusText}].`);return Object.assign(R(e),{acl:{resourceAcl:null}})}function nr(e){return"string"===typeof e.internal_resourceInfo.aclUrl}function tr(e,n){return Bt(e)?or(e.internal_acl.resourceAcl,n):Vt(e)?ur(e.internal_acl.fallbackAcl,n):null}function rr(e){if(Bt(e)){return cr(Jt(e))}if(Vt(e)){return ar(Zt(e))}return null}function or(e,n){return It(sr(Ct(Tt(e),e.internal_accessTo),n).map($t))}function cr(e){return gr(dr(Ct(Tt(e),e.internal_accessTo)))}function ir(e,n,t){return xt(e,t,G.agent,"resource",n)}function ur(e,n){return It(sr(Lt(Tt(e),e.internal_accessTo),n).map($t))}function ar(e){return gr(dr(Lt(Tt(e),e.internal_accessTo)))}function lr(e,n,t){return xt(e,t,G.agent,"default",n)}function sr(e,n){return St(e,n,G.agent)}function dr(e){return e.filter(fr)}function fr(e){return null!==Oe(e,G.agent)}function gr(e){return Nt(e,G.agent)}function hr(e,n){return Bt(e)?wr(e.internal_acl.resourceAcl,n):Vt(e)?Ar(e.internal_acl.fallbackAcl,n):null}function pr(e){if(Bt(e)){return br(Jt(e))}if(Vt(e)){return yr(Zt(e))}return null}function wr(e,n){return It(mr(Ct(Tt(e),e.internal_accessTo),n).map($t))}function br(e){return vr(Ct(Tt(e),e.internal_accessTo))}function Ar(e,n){return It(mr(Lt(Tt(e),e.internal_accessTo),n).map($t))}function yr(e){return vr(Lt(Tt(e),e.internal_accessTo))}function mr(e,n){return St(e,n,G.agentGroup)}function vr(e){return Nt(e,G.agentGroup)}function Rr(e,n,t){return xt(e,t,G.agentGroup,"resource",n)}function jr(e,n,t){return xt(e,t,G.agentGroup,"default",n)}function Or(e){return Bt(e)?_r(e.internal_acl.resourceAcl):Vt(e)?Ur(e.internal_acl.fallbackAcl):null}function _r(e){return It(Cr(Ct(Tt(e),e.internal_accessTo),X.Agent).map($t))}function Ur(e){return It(Cr(Lt(Tt(e),e.internal_accessTo),X.Agent).map($t))}function Tr(e,n){return xt(e,n,G.agentClass,"resource",X.Agent)}function Pr(e,n){return xt(e,n,G.agentClass,"default",X.Agent)}function Cr(e,n){return e.filter(e=>(function(e,n){return Ue(e,G.agentClass).includes(n)})(e,n))}function Lr(e){var n;const t=null!==(n=e.internal_resourceInfo.aclUrl)&&void 0!==n?n:"https://your.pod/mock-acl.ttl",r=Object.assign(R(e),{internal_resourceInfo:Object.assign(Object.assign({},e.internal_resourceInfo),{aclUrl:t})});return Mt(r,{resourceAcl:Qt(r),fallbackAcl:null})}function $r(e){const n=Ut(L(e)),t=n+".acl",r=Qt(function(e,n){return Object.assign(R(e),{internal_resourceInfo:Object.assign(Object.assign({},e.internal_resourceInfo),{aclUrl:n})})}(kn(n),t));return Mt(R(e),{resourceAcl:null,fallbackAcl:r})}function Ir(e){if(!bo(e))throw new Error(`An Access Control Resource for [${C(e)}] is not available. This could be because the current user is not allowed to see it, or because their Pod Server does not support Access Control Resources.`);return e.internal_acp.acr}function Er(e,n){return Object.assign(R(e),{internal_acp:Object.assign(Object.assign({},e.internal_acp),{acr:n})})}function Dr(e){let n=un(e);return n=dt(n,B.type,H.AccessControl),n}function Sr(e,n){return tn(Ir(e),n).filter(e=>Ue(e,B.type).includes(H.AccessControl))}function Nr(e,n){return Er(e,rn(Ir(e),n))}function kr(e,n){return xn(e,H.apply,n)}function Mr(e){return Ue(e,H.apply)}function Wr(e,n){return et(e,H.apply,n)}function Fr(e){return Yn(e,H.apply)}function xr(e,n){return xn(e,H.applyMembers,n)}function qr(e){return Ue(e,H.applyMembers)}function Gr(e){return Yn(e,H.applyMembers)}function Br(e){const n=Sr(e);return 0===n.length?Dr():n[0]}function zr(e){return l(e)&&Array.isArray(e.internal_resourceInfo.linkedResources[H.accessControl])&&1===e.internal_resourceInfo.linkedResources[H.accessControl].length}function Xr(e,n){var t;const r=Ir(e),o=C(r);let c=null!==(t=nn(r,o))&&void 0!==t?t:un({url:o});return c=xn(c,H.access,n),Er(e,rn(r,c))}function Hr(e,n){var t;const r=Ir(e),o=C(r);let c=null!==(t=nn(r,o))&&void 0!==t?t:un({url:o});return c=xn(c,H.accessMembers,n),Er(e,rn(r,c))}function Jr(e){const n=Ir(e),t=nn(n,C(n));return null===t?[]:Ue(t,H.access)}function Vr(e){const n=Ir(e),t=nn(n,C(n));return null===t?[]:Ue(t,H.accessMembers)}function Zr(e,n){const t=Ir(e),r=nn(t,C(t));return null===r?e:Er(e,rn(t,et(r,H.access,n)))}function Qr(e,n){const t=Ir(e),r=nn(t,C(t));return null===r?e:Er(e,rn(t,et(r,H.accessMembers,n)))}function Yr(e){const n=Ir(e),t=nn(n,C(n));return null===t?e:Er(e,rn(n,Yn(t,H.access)))}function Kr(e){const n=Ir(e),t=nn(n,C(n));return null===t?e:Er(e,rn(n,Yn(t,H.accessMembers)))}function eo(e,n){return Nr(e,kr(Br(e),n))}function no(e,n){return Nr(e,xr(Br(e),n))}function to(e){const n=Sr(e).map(e=>Mr(e)),t=new Set;return n.forEach(e=>{e.forEach(e=>t.add(e))}),Array.from(t)}function ro(e){const n=Sr(e).map(e=>qr(e)),t=new Set;return n.forEach(e=>{e.forEach(e=>t.add(e))}),Array.from(t)}function oo(e,n){return Sr(e).map(e=>Wr(e,n)).reduce(Nr,e)}function co(e,n){return Sr(e).map(e=>(function(e,n){return et(e,H.applyMembers,n)})(e,n)).reduce(Nr,e)}function io(e){return Sr(e).map(e=>Fr(e)).reduce(Nr,e)}function uo(e){return Sr(e).map(e=>Gr(e)).reduce(Nr,e)}function ao(e){let n=`# Access controls for ${C(e)}\n`;const t=to(e),r=ro(e),o=Jr(e),c=Vr(e);return 0===t.length&&0===r.length&&0===o.length&&0===c.length&&(n+="\n<no policies specified yet>\n"),t.length>0&&(n+="\nThe following policies apply to this resource:\n- ",n+=t.join("\n- ")+"\n"),o.length>0&&(n+="\nThe following policies apply to the access control resource for this resource:\n- ",n+=o.join("\n- ")+"\n"),r.length>0&&(n+="\nThe following policies apply to the children of this resource:\n- ",n+=r.join("\n- ")+"\n"),c.length>0&&(n+="\nThe following policies apply to the access control resources for children of this resource:\n- ",n+=c.join("\n- ")+"\n"),n}async function lo(e,n=O){const t=f(e),r=Object.assign(Object.assign({},O),n),o=await yn(t,r),c=await Ao(o,r);return Object.assign(o,c)}async function so(e,n=O){const t=f(e),r=Object.assign(Object.assign({},O),n),o=await N(t,r),c=await Ao(o,r);return Object.assign(o,c)}async function fo(e,n=O){const t=f(e),r=Object.assign(Object.assign({},O),n),o=await _(t,r),c=await Ao(o,r);return Object.assign(o,c)}async function go(e,n=O){const t=f(e),r=Object.assign(Object.assign({},O),n),o=await yn(t,r);if(nr(o)){return Mt(o,await jt(o,r))}{const e=await Ao(o,r);return Object.assign(o,e)}}async function ho(e,n=O){const t=f(e),r=Object.assign(Object.assign({},O),n),o=await N(t,r);if(nr(o)){return Mt(o,await jt(o,r))}{const e=await Ao(o,r);return Object.assign(o,e)}}async function po(e,n=O){const t=f(e),r=Object.assign(Object.assign({},O),n),o=await _(t,r);if(nr(o)){return Mt(o,await jt(o,r))}{const e=await Ao(o,r);return Object.assign(o,e)}}async function wo(e,n=O){const t=Ir(e),r=Object.assign(Object.assign({},O),n);return Er(e,await mn(C(t),t,r))}function bo(e){return"object"===typeof e.internal_acp&&null!==e.internal_acp&&"object"===typeof e.internal_acp.acr&&null!==e.internal_acp.acr}async function Ao(e,n){if(!zr(e))return{internal_acp:{acr:null}};let t;try{t=await yn(e.internal_resourceInfo.linkedResources[H.accessControl][0],n)}catch(r){return{internal_acp:{acr:null}}}return C(e),C(t),{internal_acp:{acr:Object.assign(t,{accessTo:C(e)})}}}function yo(e){const n=to(e).map(mo).concat(ro(e).map(mo)).concat(Jr(e).map(mo)).concat(Vr(e).map(mo));return Array.from(new Set(n))}function mo(e){const n=new URL(e);return n.hash="",n.href}function vo(e){return Ue(e,B.type).includes(H.Rule)}function Ro(e,n){return xn(e,H.allOf,n)}function jo(e,n){return et(e,H.allOf,n)}function Oo(e,n){return dt(e,H.allOf,n)}function _o(e){return Ue(e,H.allOf)}function Uo(e,n){return xn(e,H.anyOf,n)}function To(e,n){return et(e,H.anyOf,n)}function Po(e,n){return dt(e,H.anyOf,n)}function Co(e){return Ue(e,H.anyOf)}function Lo(e,n){return xn(e,H.noneOf,n)}function $o(e,n){return et(e,H.noneOf,n)}function Io(e,n){return dt(e,H.noneOf,n)}function Eo(e){return Ue(e,H.noneOf)}function Do(e){let n=un({url:f(e)});return n=st(n,B.type,H.Rule),n}function So(e,n){const t=nn(e,n);return null===t||je(t,B.type)!==H.Rule?null:t}function No(e,n){const t=Ir(e),r=C(t),o=new URL(r);o.hash=`#${n}`;const c=nn(t,o.href);return null!==c&&vo(c)?c:null}function ko(e){return tn(e).filter(vo)}function Mo(e,n){return cn(e,n)}function Wo(e,n){return rn(e,n)}function Fo(e){return Ue(e,H.agent).filter(e=>e!==H.PublicAgent&&e!==H.AuthenticatedAgent&&e!==H.CreatorAgent)}function xo(e,n){const t=Jo(e),r=Qo(e),o=ec(e);let c=dt(e,H.agent,n);return t&&(c=Vo(c)),r&&(c=Yo(c)),o&&(c=nc(c)),c}function qo(e,n){return xn(e,H.agent,n)}function Go(e,n){return et(e,H.agent,n)}function Bo(e){return Ue(e,H.group)}function zo(e,n){return dt(e,H.group,n)}function Xo(e,n){return xn(e,H.group,n)}function Ho(e,n){return et(e,H.group,n)}function Jo(e){return Ue(e,H.agent).filter(e=>e===H.PublicAgent).length>0}function Vo(e){if("object"===typeof arguments&&"boolean"===typeof arguments[1])throw new Error("The function `setPublic` no longer takes a second parameter. It is now used together with `removePublic` instead.");return xn(e,H.agent,H.PublicAgent)}function Zo(e){return et(e,H.agent,H.PublicAgent)}function Qo(e){return Ue(e,H.agent).filter(e=>e===H.AuthenticatedAgent).length>0}function Yo(e){if("object"===typeof arguments&&"boolean"===typeof arguments[1])throw new Error("The function `setAuthenticated` no longer takes a second parameter. It is now used together with `removeAuthenticated` instead.");return xn(e,H.agent,H.AuthenticatedAgent)}function Ko(e){return et(e,H.agent,H.AuthenticatedAgent)}function ec(e){return Ue(e,H.agent).filter(e=>e===H.CreatorAgent).length>0}function nc(e){if("object"===typeof arguments&&"boolean"===typeof arguments[1])throw new Error("The function `setCreator` no longer takes a second parameter. It is now used together with `removeCreator` instead.");return xn(e,H.agent,H.CreatorAgent)}function tc(e){return et(e,H.agent,H.CreatorAgent)}function rc(e){return Ue(e,H.client).filter(e=>e!==J.PublicOidcClient)}function oc(e){return Ue(e,H.client).filter(e=>e===J.PublicOidcClient).length>0}function cc(e){return xn(e,H.client,J.PublicOidcClient)}function ic(e){let n=`## Rule: ${ln(e)}\n\n`,t="";Jo(e)&&(t+="- Everyone\n"),Qo(e)&&(t+="- All authenticated agents\n"),ec(e)&&(t+="- The creator of this resource\n"),oc(e)&&(t+="- Users of any client application\n");const r=Fo(e);r.length>0&&(t+="- The following agents:\n  - ",t+=r.join("\n  - ")+"\n");const o=Bo(e);o.length>0&&(t+="- Members of the following groups:\n  - ",t+=o.join("\n  - ")+"\n");const c=rc(e);return c.length>0&&(t+="- Users of the following client applications:\n  - ",t+=c.join("\n  - ")+"\n"),n+=t.length>0?"This rule applies to:\n"+t:"<empty>\n",n}function uc(e){return Ue(e,B.type).includes(H.Policy)}function ac(e){let n=un({url:f(e)});return n=st(n,B.type,H.Policy),n}function lc(e,n){const t=nn(e,n);return null!==t&&uc(t)?t:null}function sc(e){return tn(e).filter(e=>!fn(e)&&uc(e))}function dc(e,n){return cn(e,n)}function fc(e,n){return rn(e,n)}function gc(e,n){let t=Yn(e,H.allow);return!0===n.read&&(t=xn(t,H.allow,H.Read)),!0===n.append&&(t=xn(t,H.allow,H.Append)),!0===n.write&&(t=xn(t,H.allow,H.Write)),t}function hc(e){const n=Ue(e,H.allow);return{read:n.includes(H.Read),append:n.includes(H.Append),write:n.includes(H.Write)}}function pc(e,n){let t=Yn(e,H.deny);return!0===n.read&&(t=xn(t,H.deny,H.Read)),!0===n.append&&(t=xn(t,H.deny,H.Append)),!0===n.write&&(t=xn(t,H.deny,H.Write)),t}function wc(e){const n=Ue(e,H.deny);return{read:n.includes(H.Read),append:n.includes(H.Append),write:n.includes(H.Write)}}function bc(e,n){const t=Ir(e),r=C(t),o=new URL(r);o.hash=`#${n}`;const c=nn(t,o.href);return to(e).includes(o.href)&&null!==c&&uc(c)?c:null}function Ac(e,n){const t=Ir(e),r=C(t),o=new URL(r);o.hash=`#${n}`;const c=nn(t,o.href);return Jr(e).includes(o.href)&&null!==c&&uc(c)?c:null}function yc(e){function n(e,n){return n?"denied":e?"allowed":"unspecified"}const t=hc(e),r=wc(e);let o=`## Policy: ${ln(e)}\n\n`;o+=`- Read: ${n(t.read,r.read)}\n`,o+=`- Append: ${n(t.append,r.append)}\n`,o+=`- Write: ${n(t.write,r.write)}\n`;const c=_o(e),i=Co(e),u=Eo(e);return 0===c.length&&0===i.length&&0===u.length&&(o+="\n<no rules specified yet>\n"),c.length>0&&(o+="\nAll of these rules should match:\n",o+="- "+c.join("\n- ")+"\n"),i.length>0&&(o+="\nAt least one of these rules should match:\n",o+="- "+i.join("\n- ")+"\n"),u.length>0&&(o+="\nNone of these rules should match:\n",o+="- "+u.join("\n- ")+"\n"),o}function mc(e){const n=new URL("access-control-resource",e).href;return Object.assign(Nn(n),{accessTo:e})}function vc(e,n=mc(C(e))){return Object.assign(R(e),{internal_acp:{acr:n,aprs:{}}})}const Rc={getFileWithAccessDatasets:ho,getFileWithAcr:so,getReferencedPolicyUrlAll:yo,getResourceInfoWithAccessDatasets:po,getResourceInfoWithAcr:fo,getSolidDatasetWithAccessDatasets:go,getSolidDatasetWithAcr:lo,hasAccessibleAcr:bo,saveAcrFor:wo},jc={acrAsMarkdown:ao,addAcrPolicyUrl:Xr,addMemberAcrPolicyUrl:Hr,addMemberPolicyUrl:no,addPolicyUrl:eo,getAcrPolicyUrlAll:Jr,getMemberAcrPolicyUrlAll:Vr,getMemberPolicyUrlAll:ro,getPolicyUrlAll:to,hasLinkedAcr:zr,removeAcrPolicyUrl:Zr,removeAcrPolicyUrlAll:Yr,removeMemberAcrPolicyUrl:Qr,removeMemberAcrPolicyUrlAll:Kr,removeMemberPolicyUrl:co,removeMemberPolicyUrlAll:uo,removePolicyUrl:oo,removePolicyUrlAll:io},Oc={createPolicy:ac,getAllowModes:hc,getDenyModes:wc,getPolicy:lc,getPolicyAll:sc,policyAsMarkdown:yc,removePolicy:dc,setAllowModes:gc,setDenyModes:pc,setPolicy:fc},_c={addAgent:qo,addForbiddenRuleUrl:Lo,addGroup:Xo,addOptionalRuleUrl:Uo,addRequiredRuleUrl:Ro,createRule:Do,getAgentAll:Fo,getForbiddenRuleUrlAll:Eo,getGroupAll:Bo,getOptionalRuleUrlAll:Co,getRequiredRuleUrlAll:_o,getRule:So,getRuleAll:ko,hasAuthenticated:Qo,hasCreator:ec,hasPublic:Jo,removeAgent:Go,removeForbiddenRuleUrl:$o,removeGroup:Ho,removeOptionalRuleUrl:To,removeRequiredRuleUrl:jo,removeRule:Mo,ruleAsMarkdown:ic,setAgent:xo,setForbiddenRuleUrl:Io,setGroup:zo,setOptionalRuleUrl:Po,setRequiredRuleUrl:Oo,setRule:Wo},Uc={addMockAcrTo:vc,mockAcrFor:mc};function Tc(e,n){return n?Vo(e):Zo(e)}function Pc(e,n){return n?Yo(e):Ko(e)}function Cc(e,n){return n?nc(e):tc(e)}const Lc={getForbiddenRuleurlAll:Eo,setPublic:Tc,setAuthenticated:Pc,setCreator:Cc},$c=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rc),jc),Oc),_c),Uc),Lc),Ic={getFileWithAccessDatasets:ho,getFileWithAcr:so,getReferencedPolicyUrlAll:yo,getResourceInfoWithAccessDatasets:po,getResourceInfoWithAcr:fo,getSolidDatasetWithAccessDatasets:go,getSolidDatasetWithAcr:lo,hasAccessibleAcr:bo,saveAcrFor:wo},Ec={createPolicy:ac,getAllowModes:hc,getDenyModes:wc,getPolicy:lc,getPolicyAll:sc,policyAsMarkdown:yc,removePolicy:dc,setAllowModes:gc,setDenyModes:pc,setPolicy:fc},Dc={addAgent:qo,addForbiddenRuleUrl:Lo,addGroup:Xo,addOptionalRuleUrl:Uo,addRequiredRuleUrl:Ro,createRule:Do,getAgentAll:Fo,getForbiddenRuleUrlAll:Eo,getGroupAll:Bo,getOptionalRuleUrlAll:Co,getRequiredRuleUrlAll:_o,getRule:So,getRuleAll:ko,hasAuthenticated:Qo,hasCreator:ec,hasPublic:Jo,removeAgent:Go,removeForbiddenRuleUrl:$o,removeGroup:Ho,removeOptionalRuleUrl:To,removeRequiredRuleUrl:jo,removeRule:Mo,ruleAsMarkdown:ic,setAgent:xo,setForbiddenRuleUrl:Io,setGroup:zo,setOptionalRuleUrl:Po,setRequiredRuleUrl:Oo,setRule:Wo},Sc={addMockAcrTo:vc,mockAcrFor:mc},Nc={hasLinkedAcr:zr,addAcrPolicyUrl:Xr,addMemberAcrPolicyUrl:Hr,getAcrPolicyUrlAll:Jr,getMemberAcrPolicyUrlAll:Vr,removeAcrPolicyUrl:Zr,removeAcrPolicyUrlAll:Yr,removeMemberAcrPolicyUrl:Qr,removeMemberAcrPolicyUrlAll:Kr},kc={createControl:Dr,getControl:function(e,n,t){const r=nn(Ir(e),n,t);return null!==r&&Ue(r,B.type).includes(H.AccessControl)?r:null},getAllControl:Sr,getControlAll:Sr,setControl:Nr,removeControl:function(e,n){const t=cn(Ir(e),n);return Er(e,t)},addPolicyUrl:kr,getPolicyUrlAll:Mr,removePolicyUrl:Wr,removePolicyUrlAll:Fr,addMemberPolicyUrl:xr,getMemberPolicyUrlAll:qr,removeMemberPolicyUrl:qr,removeMemberPolicyUrlAll:Gr,getForbiddenRuleurlAll:Eo,setPublic:Tc,setAuthenticated:Pc,setCreator:Cc},Mc=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ic),Ec),Dc),Sc),Nc),kc);const Wc={getFileWithAccessDatasets:ho,getFileWithAcr:so,getReferencedPolicyUrlAll:yo,getResourceInfoWithAccessDatasets:po,getResourceInfoWithAcr:fo,getSolidDatasetWithAccessDatasets:go,getSolidDatasetWithAcr:lo,hasAccessibleAcr:bo,saveAcrFor:wo},Fc={acrAsMarkdown:ao,addAcrPolicyUrl:Xr,addMemberAcrPolicyUrl:Hr,addMemberPolicyUrl:no,addPolicyUrl:eo,getAcrPolicyUrlAll:Jr,getMemberAcrPolicyUrlAll:Vr,getMemberPolicyUrlAll:ro,getPolicyUrlAll:to,hasLinkedAcr:zr,removeAcrPolicyUrl:Zr,removeAcrPolicyUrlAll:Yr,removeMemberAcrPolicyUrl:Qr,removeMemberAcrPolicyUrlAll:Kr,removeMemberPolicyUrl:co,removeMemberPolicyUrlAll:uo,removePolicyUrl:oo,removePolicyUrlAll:io},xc={createPolicy:ac,getAllowModes:hc,getDenyModes:wc,getPolicy:lc,getPolicyAll:sc,policyAsMarkdown:yc,removePolicy:dc,setAllowModes:gc,setDenyModes:pc,setPolicy:fc,createResourcePolicyFor:function(e,n){const t=Ir(e),r=new URL(C(t));r.hash=`#${n}`;let o=un({url:r.href});return o=st(o,B.type,H.Policy),o},getResourceAcrPolicy:Ac,getResourceAcrPolicyAll:function(e){const n=Ir(e);return Jr(e).map(e=>nn(n,e)).filter(e=>null!==e&&uc(e))},getResourcePolicy:bc,getResourcePolicyAll:function(e){const n=Ir(e);return to(e).map(e=>nn(n,e)).filter(e=>null!==e&&uc(e))},removeResourceAcrPolicy:function(e,n){const t=Ir(e);let r,o=n;if("string"===typeof o)try{new URL(o)}catch(c){const e=new URL(C(t));e.hash=`#${n}`,o=e.href}return r="string"===typeof o?o:ue(o)?f(o):ln(o,C(t)),null===Ac(e,new URL(r).hash.substring(1))?e:Zr(Er(e,cn(t,o)),r)},removeResourcePolicy:function(e,n){const t=Ir(e);let r,o=n;if("string"===typeof o)try{new URL(o)}catch(c){const e=new URL(C(t));e.hash=`#${n}`,o=e.href}return r="string"===typeof o?o:ue(o)?f(o):ln(o,C(t)),null===bc(e,new URL(r).hash.substring(1))?e:oo(Er(e,cn(t,o)),r)},setResourceAcrPolicy:function(e,n){const t=Ir(e);return Xr(Er(e,rn(t,n)),ln(n,C(t)))},setResourcePolicy:function(e,n){const t=Ir(e);return eo(Er(e,rn(t,n)),ln(n,C(t)))}},qc={addAgent:qo,addGroup:Xo,createRule:Do,getAgentAll:Fo,getGroupAll:Bo,getRule:So,getRuleAll:ko,removeAgent:Go,removeGroup:Ho,removeRule:Mo,ruleAsMarkdown:ic,setAgent:xo,setGroup:zo,setRule:Wo,addClient:function(e,n){return xn(e,H.client,n)},getClientAll:rc,hasAnyClient:oc,removeClient:function(e,n){return et(e,H.client,n)},setAnyClient:cc,setClient:function(e,n){const t=oc(e);let r=dt(e,H.client,n);return t&&(r=cc(r)),r},removeAnyClient:function(e){return et(e,H.client,J.PublicOidcClient)},hasAuthenticated:Qo,hasCreator:ec,hasPublic:Jo,setAuthenticated:Yo,setCreator:nc,setPublic:Vo,removeAuthenticated:Ko,removeCreator:tc,removePublic:Zo,getAnyOfRuleUrlAll:Co,addAnyOfRuleUrl:Uo,removeAnyOfRuleUrl:To,setAnyOfRuleUrl:Po,getAllOfRuleUrlAll:_o,addAllOfRuleUrl:Ro,removeAllOfRuleUrl:jo,setAllOfRuleUrl:Oo,getNoneOfRuleUrlAll:Eo,addNoneOfRuleUrl:Lo,removeNoneOfRuleUrl:$o,setNoneOfRuleUrl:Io,createResourceRuleFor:function(e,n){const t=Ir(e),r=new URL(C(t));r.hash=`#${n}`;let o=un({url:r.href});return o=st(o,B.type,H.Rule),o},getResourceRule:No,getResourceRuleAll:function(e){return tn(Ir(e)).filter(vo)},removeResourceRule:function(e,n){const t=Ir(e);let r;if("string"===typeof n)try{new URL(n),r=n}catch(c){const e=new URL(C(t));e.hash=`#${n}`,r=e.href}else r=ue(n)?f(n):ln(n);const o=No(e,new URL(r).hash.substring(1));return null===o?e:Er(e,cn(t,o))},setResourceRule:function(e,n){return Er(e,rn(Ir(e),n))}},Gc={addMockAcrTo:vc,mockAcrFor:mc},Bc=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wc),Fc),xc),qc),Gc);function zc(e,n){const t=[];return n.forEach(n=>{const r=nn(Ir(e),n);null!==r&&(Ue(r,H.anyOf).forEach(e=>t.push(e)),Ue(r,H.allOf).forEach(e=>t.push(e)),Ue(r,H.noneOf).forEach(e=>t.push(e)))}),t}function Xc(e){const n=L(e),t=to(e).concat(Jr(e)),r=zc(e,t);return t.concat(r).some(e=>e.substring(0,n.length)!==n&&!ai(e,n))}const Hc=[H.agent,H.group];function Jc(e,n,t){if(!bo(e)||Xc(e))return null;const r=Ir(e),o=Jr(e).map(e=>lc(r,e)).filter(e=>null!==e).filter(e=>Yc(e,n,t,r)),c=to(e).map(e=>lc(r,e)).filter(e=>null!==e).filter(e=>Yc(e,n,t,r)),i=o.reduce((e,n)=>{const t=Object.assign({},e),r=hc(n);return r.read&&(t.controlRead=!0),r.write&&(t.controlWrite=!0),t},{read:!1,append:!1,write:!1,controlRead:!1,controlWrite:!1}),u=c.reduce((e,n)=>{const t=Object.assign({},e),r=hc(n);return r.read&&(t.read=!0),r.append&&(t.append=!0),r.write&&(t.write=!0),t},i),a=o.reduce((e,n)=>{const t=Object.assign({},e),r=wc(n);return!0===r.read&&(t.controlRead=!1),!0===r.write&&(t.controlWrite=!1),t},u);return c.reduce((e,n)=>{const t=Object.assign({},e),r=wc(n);return!0===r.read&&(t.read=!1),!0===r.append&&(t.append=!1),!0===r.write&&(t.write=!1),t},a)}function Vc(e,n){return Jc(e,H.agent,n)}function Zc(e,n){return Jc(e,H.group,n)}function Qc(e){return Jc(e,H.agent,H.PublicAgent)}function Yc(e,n,t,r){const o=Ue(e,H.allow),c=Ue(e,H.deny);if(o.length+c.length===0)return!1;const i=_o(e).map(e=>So(r,e)).filter(ui),u=Co(e).map(e=>So(r,e)).filter(ui),a=Eo(e).map(e=>So(r,e)).filter(ui);return i.every(e=>ei(e,n,t))&&(0===u.length||u.some(e=>ei(e,n,t)))&&0===a.length}function Kc(e,n){const t=Ue(e,H.allow),r=Ue(e,H.deny);return!0===n.read&&r.includes(H.Read)||!1===n.read&&t.includes(H.Read)&&!r.includes(H.Read)||!0===n.append&&r.includes(H.Append)||!1===n.append&&t.includes(H.Append)&&!r.includes(H.Append)||!0===n.write&&r.includes(H.Write)||!1===n.write&&t.includes(H.Write)&&!r.includes(H.Write)}function ei(e,n,t){let r=!0;return Hc.forEach(n=>{r&&(r=null===Oe(e,n))}),r||Ue(e,n).includes(t)}function ni(e,n){if(!bo(e)||Xc(e))return null;const t={};return function(e,n){const t=new Set,r=to(e).concat(Jr(e));return zc(e,r).forEach(r=>{const o=nn(Ir(e),r);Ue(o,n).filter(e=>![H.PublicAgent,H.CreatorAgent,H.AuthenticatedAgent].includes(e)||n!=H.agent).forEach(e=>t.add(e))}),t}(e,n).forEach(r=>{const o=Jc(e,n,r);t[r]=o}),t}function ti(e,n,t,r){var o,c,i,u,a;if(!bo(e)||Xc(e))return null;const l=Jc(e,n,t);if(null===l)return null;const s=Ir(e),d=Jr(e).filter(n=>!ai(n,L(e))).map(e=>lc(s,e)).filter(e=>null!==e).filter(e=>Yc(e,n,t,s)),f=to(e).filter(n=>!ai(n,L(e))).map(e=>lc(s,e)).filter(e=>null!==e).filter(e=>Yc(e,n,t,s)),g=d.filter(e=>Kc(e,{read:r.controlRead,write:r.controlWrite})),h=f.filter(e=>Kc(e,{read:r.read,append:r.append,write:r.write})),p=g.filter(e=>ri(e,n,t,s)),w=h.filter(e=>ri(e,n,t,s)),b=p.map(e=>sn(e)),A=w.map(e=>sn(e));let y=b.reduce(Zr,e);y=A.reduce(oo,y);const m=Jc(y,n,t);if(null===m)return null;let v=s;const R=[];p.forEach(e=>{const[r,o]=ci(e,s,n,t);v=rn(v,r),v=o.reduce(rn,v),R.push(sn(r))});const j=[];w.forEach(e=>{const[r,o]=ci(e,s,n,t);v=rn(v,r),v=o.reduce(rn,v),j.push(sn(r))});let O=Do(L(s)+`#rule_${encodeURIComponent(n)}_${t}`);O=dt(O,n,t);const _=null!==(o=r.controlRead)&&void 0!==o?o:l.controlRead,U=null!==(c=r.controlWrite)&&void 0!==c?c:l.controlWrite;let T=p;if(_!==m.controlRead||U!==m.controlWrite){const e=L(s)+"#acr_policy"+`_${encodeURIComponent(n)}_${t}`+`_${Date.now()}_${Math.random()}`;let r=ac(e);r=gc(r,{read:!0===_,append:!1,write:!0===U}),r=xn(r,H.allOf,O),v=rn(v,r),v=rn(v,O),R.push(e),T=g}const P=null!==(i=r.read)&&void 0!==i?i:l.read,C=null!==(u=r.append)&&void 0!==u?u:l.append,$=null!==(a=r.write)&&void 0!==a?a:l.write;let I=w;if(P!==m.read||C!==m.append||$!==m.write){const e=L(s)+"#policy"+`_${encodeURIComponent(n)}_${encodeURIComponent(t)}`+`_${Date.now()}_${Math.random()}`;let r=ac(e);r=gc(r,{read:!0===P,append:!0===C,write:!0===$}),r=xn(r,H.allOf,O),v=rn(v,r),v=rn(v,O),j.push(e),I=h}let E=Er(e,v);return T.forEach(e=>{E=Zr(E,sn(e))}),R.forEach(e=>{E=Xr(E,e)}),I.forEach(e=>{E=oo(E,sn(e))}),j.forEach(e=>{E=eo(E,e)}),E}function ri(e,n,t,r){const o=Ue(e,H.allOf).some(e=>{const o=So(r,e);return null!==o&&oi(o,n,t)}),c=Ue(e,H.anyOf).some(e=>{const o=So(r,e);return null!==o&&oi(o,n,t)}),i=Ue(e,H.noneOf).some(e=>{const o=So(r,e);return null!==o&&oi(o,n,t)});return o||c||i}function oi(e,n,t){const r=[];return Hc.forEach(o=>{const c=Ue(e,o).filter(e=>e!==t||o!==n);r.push(...c)}),r.length>0}function ci(e,n,t,r){const o="_copy_wihout"+`_${encodeURIComponent(t)}_${r}`+`_${Date.now()}_${Math.random()}`,c=ii(Ue(e,H.allOf),n,o,t,r),i=ii(Ue(e,H.anyOf),n,o,t,r),u=ii(Ue(e,H.noneOf),n,o,t,r);let a=ac(sn(e)+o);return Ue(e,H.allow).forEach(e=>{a=xn(a,H.allow,e)}),Ue(e,H.deny).forEach(e=>{a=xn(a,H.deny,e)}),c.forEach(e=>{a=xn(a,H.allOf,e)}),i.forEach(e=>{a=xn(a,H.anyOf,e)}),u.forEach(e=>{a=xn(a,H.noneOf,e)}),[a,c.concat(i).concat(u)]}function ii(e,n,t,r,o){return e.map(e=>{const c=So(n,e);if(null===c)return null;let i=Do(sn(c)+t),u=!1;return Hc.forEach(e=>{Ue(c,e).forEach(n=>{e===r&&n===o||(u=!0,i=xn(i,e,n))})}),u?i:null}).filter(ui)}function ui(e){return null!==e}function ai(e,n){return["https://pod.inrupt.com","https://demo-ess.inrupt.com","https://dev-ess.inrupt.com"].some(t=>{if(!n.startsWith(t))return!1;const r=n.substring(t.length+"/".length),o=n.substring(0,t.length+"/".length+r.indexOf("/")+"/".length);return e===o+"policies/#Owner"})}function li(e,n){var t,r,o,c;if(e.controlRead!==e.controlWrite)throw new Error("For Pods using Web Access Control, controlRead and controlWrite must be equal.");return{read:null!==(t=e.read)&&void 0!==t?t:n.read,append:null!==(r=e.append)&&void 0!==r?r:n.append,write:null!==(o=e.write)&&void 0!==o?o:n.write,control:null!==(c=e.controlRead)&&void 0!==c?c:n.control}}function si(e){return{read:e.read,write:e.write,append:e.append,controlRead:e.control,controlWrite:e.control}}async function di(e,n,t,r){const o=t(Mt(e,await jt(e,r)),n);return null===o?null:si(o)}async function fi(e,n,t){const r=n(Mt(e,await jt(e,t)));if(null===r)return null;const o={};for(const[c,i]of Object.entries(r))o[c]=si(i);return o}function gi(e,n,t=O){return di(e,n,tr,t)}function hi(e,n,t=O){return di(e,n,hr,t)}function pi(e,n=O){return async function(e,n,t){const r=n(Mt(e,await jt(e,t)));return null===r?null:si(r)}(e,Or,n)}async function wi(e,n){if(!nr(e))return null;const t=Mt(e,await jt(e,n));let r;if(Bt(t))r=function(e){return e.internal_acl.resourceAcl}(t);else{if(!Vt(t))return null;r=Yt(t)}return qt(t,r)}async function bi(e,n,t){let r=null;try{return r=await Kt(e,n,t),qt(e,r)}catch(o){return null}}async function Ai(e,n,t,r,o,c){const i=await wi(e,c);if(null===i)return null;const u=r(i,n),a=o(Jt(i),n,li(t,u));return await bi(i,a,c)}async function yi(e,n,t=O){return await async function(e,n,t,r,o){const c=await wi(e,o);if(null===c)return null;const i=r(Jt(c),li(n,t(c)));return await bi(c,i,o)}(e,n,Or,Tr,t)}async function mi(e,n,t=O){const r=await fo(e,t);return bo(r)?Vc(r,n):nr(r)?await gi(r,n,t):null}async function vi(e,n,t,r=O){const o=await fo(e,r);if(bo(o)){const e=function(e,n,t){return ti(e,H.agent,n,t)}(o,n,t);if(e)try{return await wo(e,r),Vc(e,n)}catch(c){return null}return null}if(nr(o)){if(t.controlRead!=t.controlWrite)throw new Error(`When setting access for a Resource in a Pod implementing Web Access Control (i.e. [${L(o)}]), `+"`controlRead` and `controlWrite` should have the same value.");const e=t;return await async function(e,n,t,r=O){return await Ai(e,n,t,tr,ir,r)}(o,n,e,r),await gi(o,n,r)}return null}async function Ri(e,n=O){const t=await fo(e,n);return bo(t)?ni(t,H.agent):nr(t)?await function(e,n=O){return fi(e,rr,n)}(t,n):null}async function ji(e,n,t=O){const r=await fo(e,t);return bo(r)?Zc(r,n):nr(r)?await hi(r,n,t):null}async function Oi(e,n=O){const t=await fo(e,n);return bo(t)?ni(t,H.group):nr(t)?await function(e,n=O){return fi(e,pr,n)}(t,n):null}async function _i(e,n,t,r=O){const o=await fo(e,r);if(bo(o)){const e=function(e,n,t){return ti(e,H.group,n,t)}(o,n,t);if(e)try{return await wo(e,r),Zc(e,n)}catch(c){return null}return null}if(nr(o)){if(t.controlRead!=t.controlWrite)throw new Error(`When setting access for a Resource in a Pod implementing Web Access Control (i.e. [${L(o)}]), `+"`controlRead` and `controlWrite` should have the same value.");const e=t;return await async function(e,n,t,r=O){return await Ai(e,n,t,hr,Rr,r)}(o,n,e,r),await hi(o,n,r)}return null}async function Ui(e,n=O){const t=await fo(e,n);return bo(t)?Qc(t):nr(t)?await pi(t,n):null}async function Ti(e,n,t=O){const r=await fo(e,t);if(bo(r)){const e=function(e,n){return ti(e,H.agent,H.PublicAgent,n)}(r,n);if(e)try{return await wo(e,t),Qc(e)}catch(o){return null}return null}if(nr(r)){if(n.controlRead!=n.controlWrite)throw new Error(`When setting access for a Resource in a Pod implementing Web Access Control (i.e. [${L(r)}]), `+"`controlRead` and `controlWrite` should have the same value.");const e=n;return await yi(r,e,t),await pi(r,t)}return null}var Pi=Object.freeze({__proto__:null,getAgentAccess:mi,setAgentAccess:vi,getAgentAccessAll:Ri,getGroupAccess:ji,getGroupAccessAll:Oi,setGroupAccess:_i,getPublicAccess:Ui,setPublicAccess:Ti,getAccessFor:async function(e,n,t=O,r=O){if("agent"===n){if("string"!==typeof t)throw new Error("When reading Agent-specific access, the given agent cannot be left undefined.");return await mi(e,t,r)}if("group"===n){if("string"!==typeof t)throw new Error("When reading Group-specific access, the given group cannot be left undefined.");return await ji(e,t,r)}if("public"===n){if("string"===typeof t)throw new Error(`When reading public access, no actor type should be specified (here [${t}]).`);return await Ui(e,t)}return null},getAccessForAll:async function(e,n,t=O){return"agent"===n?await Ri(e,t):"group"===n?await Oi(e,t):null},setAccessFor:async function(e,n,t,r=O,o=O){if("agent"===n){if("string"!==typeof r)throw new Error("When writing Agent-specific access, the given agent cannot be left undefined.");return await vi(e,r,t,o)}if("group"===n){if("string"!==typeof r)throw new Error("When writing Group-specific access, the given group cannot be left undefined.");return await _i(e,r,t,o)}if("public"===n){if("string"===typeof r)throw new Error(`When writing public access, no actor type should be specified (here [${r}]).`);return await Ti(e,t,r)}return null}})}}]);